<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Movie Night for Mi Amor</title>

  <style>
    body {
      font-family: system-ui, Segoe UI, Arial, sans-serif;
      margin: 0;
      color: #f5f5f7;
    }

    .bgvid {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -2;
    }

    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      z-index: -1;
    }

    .wrap {
      max-width: 920px;
      margin: 0 auto;
      padding: 32px 18px 64px;
      position: relative;
      z-index: 2;
    }

    .card {
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 20px;
      padding: 24px;
      backdrop-filter: blur(4px);
    }

    h1 {
      font-size: 36px;
      margin: 0 0 10px;
      cursor: pointer;
      user-select: none;
    }

    h2 { margin: 22px 0 10px; }

    .sub {
      opacity: 0.9;
      margin-bottom: 18px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }

    @media (min-width: 720px) {
      .grid { grid-template-columns: 1fr 1fr; }
    }

    .pill {
      display: inline-block;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,0.12);
      border: 1px solid rgba(255,255,255,0.22);
      margin-bottom: 8px;
      font-weight: 600;
    }

    .row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 14px;
      align-items: center;
    }

    button {
      cursor: pointer;
      border-radius: 14px;
      padding: 12px 16px;
      font-weight: 650;
      border: none;
    }

    .btn {
      background: #b11226;
      color: #fff;
    }

    .btn2 {
      background: rgba(255,255,255,0.15);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.25);
    }

    input[type="text"], input[type="password"], input {
      width: 100%;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.25);
      background: rgba(255,255,255,0.08);
      color: #fff;
      font-size: 16px;
      box-sizing: border-box;
    }

    .small {
      opacity: 0.8;
      font-size: 13px;
      margin-top: 10px;
    }

    .hidden { display: none; }

    .ok { color: #9bffb2; font-weight: 650; }
    .err { color: #ff9a9a; font-weight: 650; }

    hr {
      border: 0;
      border-top: 1px solid rgba(255,255,255,0.25);
      margin: 20px 0;
    }

    .topbar {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 12px;
      gap: 10px;
      flex-wrap: wrap;
    }

    /* Modal */
    .modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 80;
    }

    .modal.show { display: flex; }

    .modal-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.55);
      backdrop-filter: blur(3px);
      opacity: 0;
      animation: fadeIn 260ms ease forwards;
    }

    .modal-card {
      position: relative;
      max-width: 720px;
      width: 100%;
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.22);
      border-radius: 20px;
      padding: 18px 18px 16px;
      transform: translateY(10px);
      opacity: 0;
      animation: popIn 320ms ease forwards;
    }

    .modal-title {
      font-size: 22px;
      margin: 0 0 8px;
    }

    .modal-text {
      margin: 0 0 12px;
      opacity: 0.92;
      line-height: 1.45;
    }

    @keyframes fadeIn { to { opacity: 1; } }
    @keyframes popIn { to { transform: translateY(0); opacity: 1; } }

    /* Cozy checklist */
    .checklist {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    @media (min-width: 720px) {
      .checklist { grid-template-columns: 1fr 1fr; }
    }
    .check-item {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      padding: 12px;
      border-radius: 16px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.14);
      user-select: none;
    }
    .check-item .box {
      width: 18px;
      height: 18px;
      border-radius: 4px;
      border: 1px solid rgba(255,255,255,0.35);
      background: rgba(255,255,255,0.08);
      margin-top: 2px;
      flex: 0 0 auto;
      position: relative;
      cursor: pointer;
    }
    .check-item.done .box {
      background: rgba(255,255,255,0.85);
      border-color: rgba(255,255,255,0.85);
    }
    .check-item.done .box:after {
      content: "";
      position: absolute;
      left: 4px;
      top: 1px;
      width: 7px;
      height: 12px;
      border: solid rgba(0,0,0,0.75);
      border-width: 0 3px 3px 0;
      transform: rotate(45deg);
    }
    .check-item .label {
      line-height: 1.3;
      opacity: 0.95;
      cursor: pointer;
    }
    .check-item.done .label {
      opacity: 0.75;
      text-decoration: line-through;
    }

    /* Photo gallery */
    .gallery { margin-top: 10px; }

    .gallery-frame {
      position: relative;
      border-radius: 18px;
      overflow: hidden;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.14);
    }

    .gallery-img {
      width: 100%;
      height: 440px;
      object-fit: cover;
      display: block;
      background: rgba(0,0,0,0.35);
    }

    .gallery-img.portrait { object-fit: contain; }

    @media (max-width: 720px) {
      .gallery-img { height: 340px; }
    }

    .gallery-controls {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .gallery-caption {
      margin-top: 10px;
      opacity: 0.9;
    }

    .dots {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.35);
      background: rgba(255,255,255,0.12);
      cursor: pointer;
    }

    .dot.active { background: rgba(255,255,255,0.85); }

    /* Toast */
    .toast {
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.55);
      border: 1px solid rgba(255,255,255,0.22);
      color: #fff;
      padding: 10px 12px;
      border-radius: 14px;
      opacity: 0;
      pointer-events: none;
      z-index: 90;
      transition: opacity 220ms ease;
      max-width: 92vw;
    }
    .toast.show { opacity: 1; }

    /* Easter egg hotspots (invisible) */
    .hotspot-layer {
      position: fixed;
      inset: 0;
      z-index: 1;
      pointer-events: none;
    }
    .hotspot {
      position: absolute;
      pointer-events: auto;
      background: rgba(255,255,255,0.0);
      border-radius: 16px;
    }
  </style>
</head>

<body>
  <video class="bgvid" autoplay muted loop playsinline>
    <source src="fireplace.mp4" type="video/mp4">
  </video>
  <div class="overlay"></div>

  <!-- Easter egg hotspots overlay (positions are approximate, adjust if your video differs) -->
  <div class="hotspot-layer">
    <!-- Stocking on left -->
    <div class="hotspot" style="left: 8%; top: 20%; width: 14%; height: 22%;"
         onclick="openModal({title:'A little secret ‚ù§Ô∏è', text:`I love to hang out with you, let's hang out again soon.`, primaryText:'Okay', tip:`Tip: tap outside this box to close.`})">
    </div>

    <!-- Gifts bottom left -->
    <div class="hotspot" style="left: 8%; top: 66%; width: 20%; height: 20%;"
         onclick="openModal({title:'A little secret ‚ù§Ô∏è', text:`Ho Ho Ho... I've got the Ho-ts for you.`, primaryText:'Okay', tip:`Tip: tap outside this box to close.`})">
    </div>

    <!-- Window snow bottom right -->
    <div class="hotspot" style="left: 68%; top: 54%; width: 24%; height: 26%;"
         onclick="openModal({title:'A little secret ‚ù§Ô∏è', text:`But baby, it's cold outside...`, primaryText:'Okay', tip:`Tip: tap outside this box to close.`})">
    </div>

    <!-- Brown chair right -->
    <div class="hotspot" style="left: 72%; top: 36%; width: 22%; height: 22%;"
         onclick="openModal({title:'A little secret ‚ù§Ô∏è', text:`Come a little closer Dear`, primaryText:'Okay', tip:`Tip: tap outside this box to close.`})">
    </div>
  </div>

  <audio id="bgm" preload="auto" loop>
    <source src="song.mp3" type="audio/mpeg">
  </audio>

  <div id="modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop" onclick="closeModal()"></div>
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Message">
      <p class="modal-title" id="modalTitle">Message</p>
      <p class="modal-text" id="modalText">...</p>
      <div class="row">
        <button class="btn" id="modalPrimaryBtn" onclick="closeModal()">Okay</button>
        <button class="btn2" id="modalSecondaryBtn" onclick="toggleMusic()">Music On/Off</button>
      </div>
      <p class="small" id="modalTip" style="margin:10px 0 0;">Tip: tap outside this box to close.</p>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <div class="wrap">
    <div class="topbar">
      <button id="musicBtn" class="btn2" onclick="toggleMusic()">Music: Off</button>
      <button class="btn2" onclick="hug()">I need a hug</button>
    </div>

    <div class="card">
      <h1 onclick="showEasterEgg('title')">Movie Night for mi amor</h1>
      <p class="sub">Cozy night by the fire, just you and me. Tonight is for you.</p>

      <div class="lockbox">
        <p>Enter the secret code from your movie ticket, mi amor:</p>
        <input id="code" placeholder="Type the code here" autocomplete="off">
        <div class="row">
          <button class="btn" onclick="unlock()">Unlock</button>
          <button class="btn2" onclick="hint()">Need a hint</button>
        </div>
        <p id="status" class="small"></p>
      </div>

      <div id="content" class="hidden">
        <hr>

        <h2>Tonight‚Äôs plan</h2>
        <div class="grid">
          <div class="card">
            <div class="pill">Step 1</div>
            <p>You pick the movie, whatever you desire, my love.</p>
          </div>
          <div class="card">
            <div class="pill">Step 2</div>
            <p>Blankets, cozy clothes or pajamas, fireplace vibes, dim the lights.</p>
          </div>
          <div class="card">
            <div class="pill">Step 3</div>
            <p>Popcorn, snacks, and refills handled by me. I promise to pause the movie.</p>
          </div>
          <div class="card">
            <div class="pill">Step 4</div>
            <p>Wine, cheese, and snacks. Cheers to us, siempre.</p>
          </div>
        </div>

        <h2>Cozy checklist</h2>
        <div class="checklist" id="checklist"></div>
        <div class="row">
          <button class="btn2" onclick="resetChecklist()">Reset checklist</button>
          <button class="btn2" onclick="tinySurprise()">Tiny surprise</button>
        </div>

        <h2>A year of 'Us' 2025 memories</h2>
        <div class="gallery">
          <div class="gallery-frame">
            <img id="galleryImg" class="gallery-img" src="p01.jpg" alt="Photo memory">
          </div>

          <div class="gallery-controls">
            <button class="btn2" onclick="prevPhoto()">Previous</button>
            <button class="btn2" onclick="nextPhoto()">Next</button>
          </div>

          <div class="dots" id="dots"></div>
          <p class="gallery-caption" id="galleryCaption"></p>
        </div>

        <h2>A note for you</h2>
        <div class="card">
          <p>
            Mi amor, I love you. Thank you for everything you do and for making our home feel warm,
            safe, and full of love. Tonight is simple, relax, laugh, and let me spoil you a little.
          </p>
          <p style="margin-top:12px; opacity:0.9;">Love you always, Hubby</p>
        </div>

        <div class="row">
          <button class="btn" onclick="startNight()">Start movie night</button>
          <button class="btn2" onclick="window.print()">Print this page</button>
        </div>

        <p class="small">Feliz Navidad ‚ù§Ô∏è</p>
      </div>
    </div>
  </div>

  <script>
    const SECRET = "NAVIDADCONMIAMOR";

    const bgm = document.getElementById("bgm");
    const musicBtn = document.getElementById("musicBtn");
    const modal = document.getElementById("modal");
    const modalTitle = document.getElementById("modalTitle");
    const modalText = document.getElementById("modalText");
    const modalTip = document.getElementById("modalTip");
    const modalPrimaryBtn = document.getElementById("modalPrimaryBtn");
    const toast = document.getElementById("toast");

    let musicOn = false;
    let primed = false;

    // Start music on first user interaction anywhere (browser requirement)
    function primeMusic() {
      if (primed) return;
      primed = true;

      const attempt = () => {
        if (!musicOn) toggleMusic(true);
        window.removeEventListener("click", attempt);
        window.removeEventListener("touchstart", attempt);
        window.removeEventListener("keydown", attempt);
      };

      window.addEventListener("click", attempt, { once: true });
      window.addEventListener("touchstart", attempt, { once: true });
      window.addEventListener("keydown", attempt, { once: true });

      showToast("Tap anywhere to start music.");
    }
    primeMusic();

    // Checklist (fixed)
    const checklistItems = [
      { id: "blankets", text: "Blankets ready" },
      { id: "cozy", text: "Cozy clothes or pajamas on" },
      { id: "lights", text: "Lights dimmed" },
      { id: "candles", text: "Candles lit" },
      { id: "snacks", text: "Snacks set out" },
      { id: "popcorn", text: "Popcorn ready" },
      { id: "wine", text: "Wine poured, cheese ready" },
      { id: "phones", text: "Phones on silent" }
    ];

    function loadChecklistState() {
      try {
        const saved = localStorage.getItem("movieNightChecklist");
        return saved ? JSON.parse(saved) : {};
      } catch {
        return {};
      }
    }

    function saveChecklistState(state) {
      try {
        localStorage.setItem("movieNightChecklist", JSON.stringify(state));
      } catch {}
    }

    function renderChecklist() {
      const state = loadChecklistState();
      const el = document.getElementById("checklist");
      el.innerHTML = "";

      checklistItems.forEach(item => {
        const wrapper = document.createElement("div");
        wrapper.className = "check-item" + (state[item.id] ? " done" : "");

        const box = document.createElement("div");
        box.className = "box";
        box.setAttribute("role", "checkbox");
        box.setAttribute("aria-checked", state[item.id] ? "true" : "false");
        box.onclick = (e) => { e.stopPropagation(); toggleChecklist(item.id); };

        const label = document.createElement("div");
        label.className = "label";
        label.textContent = item.text;
        label.onclick = (e) => { e.stopPropagation(); toggleChecklist(item.id); };

        wrapper.appendChild(box);
        wrapper.appendChild(label);
        el.appendChild(wrapper);
      });
    }

    function toggleChecklist(id) {
      const state = loadChecklistState();
      state[id] = !state[id];
      saveChecklistState(state);
      renderChecklist();
    }

    function resetChecklist() {
      saveChecklistState({});
      renderChecklist();
      showToast("Checklist reset.");
    }

    // Photo gallery
    const photos = [
      { src: "p01.jpg", caption: "One of my favorite moments with you.", portrait: true },
      { src: "p02.jpg", caption: "Us, doing life together.", portrait: true },
      { src: "p03.jpg", caption: "My love.", portrait: false },
      { src: "p04.jpg", caption: "Always my favorite view.", portrait: true },
      { src: "p05.jpg", caption: "This one makes me smile.", portrait: true },
      { src: "p06.jpg", caption: "You and me.", portrait: false },
      { src: "p07.jpg", caption: "Mi amor.", portrait: false },
      { src: "p08.jpg", caption: "My person.", portrait: false },
      { src: "p09.jpg", caption: "Forever vibes.", portrait: false },
      { src: "p10.jpg", caption: "I love our story.", portrait: true },
      { src: "p11.jpg", caption: "Best memories are with you.", portrait: true },
      { src: "p12.jpg", caption: "Still choosing you.", portrait: false },
      { src: "p13.jpg", caption: "My safe place.", portrait: false },
      { src: "p14.jpg", caption: "You make everything better.", portrait: false },
      { src: "p15.jpg", caption: "Cheers to us, siempre.", portrait: true }
    ];

    let photoIndex = 0;

    function buildDots() {
      const dots = document.getElementById("dots");
      dots.innerHTML = "";
      photos.forEach((_, i) => {
        const d = document.createElement("div");
        d.className = "dot" + (i === photoIndex ? " active" : "");
        d.onclick = () => goToPhoto(i);
        dots.appendChild(d);
      });
    }

    function renderPhoto() {
      const img = document.getElementById("galleryImg");
      const caption = document.getElementById("galleryCaption");

      img.src = photos[photoIndex].src;
      caption.textContent = photos[photoIndex].caption || "";

      if (photos[photoIndex].portrait) img.classList.add("portrait");
      else img.classList.remove("portrait");

      buildDots();
    }

    function nextPhoto() {
      photoIndex = (photoIndex + 1) % photos.length;
      renderPhoto();
    }

    function prevPhoto() {
      photoIndex = (photoIndex - 1 + photos.length) % photos.length;
      renderPhoto();
    }

    function goToPhoto(i) {
      photoIndex = i;
      renderPhoto();
    }

    // Easter eggs
    function showEasterEgg(source) {
      let msg = "";
      if (source === "title") msg = "Mi amor, you are my favorite. Always.";
      else msg = "A little secret ‚ù§Ô∏è";

      openModal({ title: "A little secret ‚ù§Ô∏è", text: msg, primaryText: "Okay", tip: "Tip: tap outside this box to close." });
    }

    function tinySurprise() {
      openModal({
        title: "Secret unlocked ‚ù§Ô∏è",
        text: "Secret unlocked. I still choose you every day, and I always will. Which is really not a secret",
        primaryText: "Click if you agree",
        tip: "Tip: It's the red button!"
      });
    }

    function hug() {
      openModal({
        title: "Come here ü§ç",
        text: "Big hug. No talking needed. Just you and me. I love you, mi amor.",
        primaryText: "Okay",
        tip: "Tip: tap outside this box to close."
      });
    }

    function unlock() {
      const val = (document.getElementById("code").value || "").trim().toUpperCase();
      const status = document.getElementById("status");

      if (val === SECRET) {
        document.getElementById("content").classList.remove("hidden");
        document.querySelector(".lockbox").style.display = "none";
        status.innerHTML = '<span class="ok">Unlocked. Movie night awaits, mi amor.</span>';
        if (!musicOn) toggleMusic(true);
      } else {
        status.innerHTML = '<span class="err">Not quite. Try again.</span>';
      }
    }

    function hint() {
      document.getElementById("status").textContent = "Hint: look at the movie ticket.";
    }

    function startNight() {
      openModal({
        title: "Movie night begins ‚ù§Ô∏è",
        text: "Mi amor, get comfy. I‚Äôve got everything handled. All you have to do is relax and enjoy.",
        primaryText: "Okay",
        tip: "Tip: tap outside this box to close."
      });
      if (!musicOn) toggleMusic(true);
    }

    // Modal helpers
    function openModal({ title, text, primaryText, tip }) {
      modalTitle.textContent = title;
      modalText.textContent = text;
      modalPrimaryBtn.textContent = primaryText || "Okay";
      modalTip.textContent = tip || "Tip: tap outside this box to close.";
      modal.classList.add("show");
      modal.setAttribute("aria-hidden", "false");
    }

    function closeModal() {
      modal.classList.remove("show");
      modal.setAttribute("aria-hidden", "true");
    }

    // Music toggle
    function toggleMusic(silent = false) {
      if (!musicOn) {
        bgm.volume = 0.45;
        bgm.play().then(() => {
          musicOn = true;
          musicBtn.textContent = "Music: On";
          if (!silent) showToast("Music on.");
        }).catch(() => {
          musicOn = false;
          musicBtn.textContent = "Music: Off";
          if (!silent) showToast("Music can‚Äôt start until you tap the page.");
        });
      } else {
        bgm.pause();
        musicOn = false;
        musicBtn.textContent = "Music: Off";
        if (!silent) showToast("Music off.");
      }
    }

    function showToast(text) {
      toast.textContent = text;
      toast.classList.add("show");
      window.clearTimeout(window.__toastTimer);
      window.__toastTimer = window.setTimeout(() => {
        toast.classList.remove("show");
      }, 1700);
    }

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeModal();
      if (e.key === "ArrowRight") nextPhoto();
      if (e.key === "ArrowLeft") prevPhoto();
    });

    renderChecklist();
    renderPhoto();
  </script>

</body>
</html>
